
# export_licenses.py
A tool to extract registered Fortinet devices from a FortiCare account and list their associated license entitlements and contract codes

## Requirements
 - A FortiCare support account with devices registered
 - A FortiCare account ID (will look like a GUID e.g. ABCD1234-A12B-1234-ABAB-12345678910A)
 - A FortiCare account API token (looks like a long password)
 - requests, argparse and csv standard python modules installed
 
 Some (public) instructions from Fortinet to generate these are here: https://community.fortinet.com/t5/FortiCloud-Products/Technical-Tip-API-how-to-retrieve-list-of-registered-units-for/ta-p/194760
 
 ## Usage
 Move the included credentials.py.example file to credentials.py and fill out the account ID (username) and the API token (password)
 E.g.
 
     username = "ABCD1234-A12B-1234-ABAB-12345678910A"
     password = "MyLongAutoGeneratedPasswordHere"
     
  Run the file
  
    python export_licenses.py [--output-file output_csv_filename] [--account-id account_id] [--api-token api_token]
 Where the arguments are:
 | Argument      | Needed value                         | Required when                                 | Example value                        |
|---------------|--------------------------------------|-----------------------------------------------|--------------------------------------|
| --output-file | A location to save the CSV report to | Not required                                  | Output.csv                           |
| --account-id  | The FortiCare account ID             | When username not specified in credentials.py | ABCD1234-A12B-1234-ABAB-12345678910A |
| --api-token   | The FortiCare API token              | When password not specified in credentials.py | MyLongAutoGeneratedPasswordHere      |
    
  You can run without the file without any arguments if username and password are specified in credentials.py
    
    
    
## Output

You will get a CSV formatted like this:
| serialNumber | registrationDate    | productModel    | contracts                                                                                    | SKUs                                                                                   | Entitlements                                                                                                                                                                                 |
|--------------|---------------------|-----------------|----------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| FTK-Serial1  | 2022-06-18T12:42:58 | FortiGate 1800F | 5999WK089692<br>8913EK551047<br>9563BD247362<br>7956DC526535<br>3490UG308959<br>8710UE134473 | FC-10-SKU-1<br>FC-10-SKU-2<br>FC-10-SKU-3<br>FC-10-SKU-4<br>FC-10-SKU-5<br>FC-10-SKU-6 | Description of entitlement 1<br>Description of entitlement 2<br>Description of entitlement 3<br>Description of entitlement 4<br>Description of entitlement 5<br>Description of entitlement 6 |
                                                                                                                                                                                                                                                                                                                                                                 
